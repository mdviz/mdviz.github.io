<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <!--Libraries-->
    <script src="libs/d3/d3.min.js" charset="utf-8"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js"></script>


    <script src="libs/queue/queue.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/plotly_charts.js"></script>
    <script src="libs/sprintf-js/src/sprintf.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <script src="js/chloroQuantile.js"></script>
    <script src="libs/simple_statistics.js"></script>


    <script src="libs/leaflet-0.7.3/leaflet.js"></script>
    <script src="libs/Leaflet.label-master/src/Label.js"></script>
    <script src="libs/Leaflet.label-master/src/BaseMarkerMethods.js"></script>
    <script src="libs/Leaflet.label-master/src/Marker.Label.js"></script>
    <script src="libs/Leaflet.label-master/src/CircleMarker.Label.js"></script>
    <script src="libs/Leaflet.label-master/src/Path.Label.js"></script>
    <script src="libs/Leaflet.label-master/src/Map.Label.js"></script>
    <script src="libs/Leaflet.label-master/src/FeatureGroup.Label.js"></script>
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDy9AdcDTx4VzH_-5g0TaQzJBDZpjHBbpo"></script> -->
    <script src="libs/underscore/underscore-min.js"></script>

    <!--Data Loads-->
    <!--<script src="data/pumasimp2_v1.json"></script>-->
    <script src="data/features.js"></script>
    <!--Stylesheets-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="libs/leaflet-0.7.3/leaflet.css"/>
    <link rel="stylesheet" type="text/css" href="css/main_style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="libs/Leaflet.label-master/dist/leaflet.label.css"/>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css">


    <title></title>


</head>
<body>
<div class="row clearfix">
    <div class="col-lg-12" id="topTitle">
        <div id="dropdown_row"><select id="drop" class="selectpicker" data-live-search="true"></select></div>
    </div>

</div>


<div class="row clearfix">

    <div class="col-lg-6">
        <div id="sourceMap"></div>
    </div>

    <div class="col-lg-6">
        <div class="tabContainer">
            <ul class="tabs">
                <li class="tab-link-current" data-tab="tab-2">Charts</li>
                <li class="tab-link" data-tab="tab-3">Specifics</li>
            </ul>

            <div id="tab-2" class="tab-content current">
                <!--                        <p><strong>Click Chart to View Different Asset &nbsp;&nbsp;&nbsp; </strong>
                                           <button type="button" class="Normal btn btn-default dropdown-toggle" onclick="normalCharts()"> Normalize
                                       </button> </p> -->
                <div class="col-md-6 column">
                    <div class="charts" id="chart"></div>
                </div>
                <div class="col-md-6 column">
                    <div class="charts" id="chart1"></div>
                </div>
                <div class="col-md-6 column">
                    <div class="charts" id="chart2"></div>
                </div>
                <div class="col-md-6 column">
                    <div class="charts" id="chart3"></div>
                </div>
            </div>

            <div id="tab-3" class="tab-content">
                <p>Mauris eleifend est et turpis. Duis id erat. Suspendisse potenti. Aliquam vulputate, pede vel
                    vehicula accumsan, mi neque rutrum erat, eu congue orci lorem eget lorem. Vestibulum non ante. Class
                    aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce sodales.
                    Quisque eu urna vel enim commodo pellentesque. Praesent eu risus hendrerit ligula tempus pretium.
                    Curabitur lorem enim, pretium nec, feugiat nec, luctus a, lacus.</p>

                <p>Duis cursus. Maecenas ligula eros, blandit nec, pharetra at, semper at, magna. Nullam ac lacus. Nulla
                    facilisi. Praesent viverra justo vitae neque. Praesent blandit adipiscing velit. Suspendisse
                    potenti. Donec mattis, pede vel pharetra blandit, magna ligula faucibus eros, id euismod lacus dolor
                    eget odio. Nam scelerisque. Donec non libero sed nulla mattis commodo. Ut sagittis. Donec nisi
                    lectus, feugiat porttitor, tempor ac, tempor vitae, pede. Aenean vehicula velit eu tellus interdum
                    rutrum. Maecenas commodo. Pellentesque nec elit. Fusce in lacus. Vivamus a libero vitae lectus
                    hendrerit hendrerit.</p>

                <p><strong>Click to see Percentages &nbsp;&nbsp;&nbsp; </strong>
                    <button type="button" class="Normal btn btn-default dropdown-toggle" id="spNormal" value=0
                            onclick="normalSpecial()"> Normalize
                    </button>
                </p>
                <div id="context"></div>
            </div>
        </div>
    </div>
</div>

<script>
    var viz_globals = {};
    queue()
            .defer(d3.json, "data/pumas_wgs_sina.json")
            .await(ready);

    function ready(error, pumas) {
        var pumas = pumas;

        viz_globals.pumas = pumas;
        puma_viz = new PumaViz('sourceMap', pumas);
        plotly_test = new PlotlyLineViz('chart');
//        plotly_test = new PlotlyLineViz('chart1');
//        plotly_test = new PlotlyLineViz('chart2');
//        plotly_test = new PlotlyLineViz('chart3');

    }


    $(document).ready(function () {

        $('ul.tabs li').click(function () {
            var tab_id = $(this).attr('data-tab');

            $('ul.tabs li').removeClass('current');
            $('.tab-content').removeClass('current');

            $(this).addClass('current');
            $("#" + tab_id).addClass('current');
        });

        $("#menu-toggle").click(function (e) {
            console.log("fired");
            e.preventDefault();
            $("#wrapper").toggleClass("toggled");
        });

        var newSelect = $('.selectpicker')[0];

        var selectHTML = "";
        Object.keys(feature_groups).forEach(function(d){
            selectHTML += "<optgroup label=" + d + ">";
            feature_groups[d].forEach(function(i){
                selectHTML += "<option value='" + i + "'>" + feature_groups_back_lookup[i] + "</option>";
            });
            selectHTML += "</optgroup>"

        });

//        features.unshift('Select Metric');
//        for (i = 0; i < features.length; i = i + 1) {
//            selectHTML += "<option value='" + features[i] + "'>" + features[i] + "</option>";
//        }

        newSelect.innerHTML = selectHTML;
        document.getElementById('dropdown_row').appendChild(newSelect);
    });

    $("#drop").change(function () {
        console.log('In dropdown change event');
        puma_viz.updateDisplay();
        plotly_test.wrangleData();
    });

</script>
</body>
</html>